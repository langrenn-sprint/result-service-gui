{% extends "open_base.html" %}
{% block titlecontainer %}
  <div class="w3-container">
{% endblock %}

{% block titleheader %}
  Startlister {{ valgt_klubb }}{{ valgt_klasse }}
{% endblock %}

{% block refresh %}{% if valgt_klasse == "live" %}60{% endif %}{% endblock %}

{% block titlemain %}
  Startlister {{ valgt_klubb }}{{ valgt_klasse }}
{% endblock %}

{% block menuitems %}
  <li class=dropdown id=topborder>
    <a href=javascript:void(0) class=dropbtn>Velg klasse</a>
    <div class=dropdown-content>
      {% for klasse in raceclasses %}
        <a href=start?klasse={{ klasse.name }}&event_id={{ event_id }}>{{ klasse.ageclass_name }}</a>
      {% endfor %}
    </div>
  </li>
  <li class=dropdown id=topborder>
    <a href="start?klasse=live&event_id={{ event_id }}" class=dropbtn alt="Se hvem som starter nå, viser de neste 8 heat">Starter nå</a>
  </li>
{% endblock %}

{% block content %}
  {% if valgt_klasse == "live" %}
  <div id="tid" class=timetitle>Klokken er {{ local_time_now }}</div>
  {% endif %}

  {% if event.competition_format == "Interval Start" %}
    <table>
       <tr id=headerblue>
        <td>Startnummer</td>
        <td>Tid</td>
        <td>Navn</td>
        <td>Klubb</td>
        <td>Team</td>
        <td>Klasse</td>
      </tr>
      {% for start in races.startliste %}
          <tr>
            <td>{{ start.bib }}</td>
            <td>{{ start.scheduled_start_time[-8:] }}</td>
            <td>{{ start.name }}</td>
            <td>{{ start.club }}</td>
            <td>{{ start.team }}</td>
            <td>{{ start.ageclass }}</td>
          </tr>
      {% endfor %}
      <tr>
        <td id=spacer colspan=4> </td>
      </tr>
    </table>
    <div id=spacer></div>
  {% else %}
    {% if valgt_klasse != "live" %}
      <table>
        <tr id=spacer></tr>
        <tr id=headerblue>
          <td>Løpsklasse</td>
          <td>Kvartfinale start</td>
          <td>Semifinaler</td>
          <td>Finaler</td>
          <td>Antall deltakere</td>
        </tr>
        {% for raceclass in raceplan_summary %}
          {% if (valgt_klasse == "") or valgt_klasse == raceclass.name %}
            <tr>
              <td>{{ raceclass.name }}</td>
              <td>{{ raceclass.timeQ }}</td>
              <td>{{ raceclass.timeS }}</td>
              <td>{{ raceclass.timeF }}</td>
              <td>{{ raceclass.no_of_contestants }}</td>
            </tr>
          {% endif %}
        {% endfor %}
      </table>
    {% endif %}
    <div id=spacer></div>
    <div class="w3-row-padding">
      <div class="{{ colclass }}">
        <table>
      {% for race in races %}
        {% if loop.index0 in colseparators %}
            </table>
          </div>
          <div class="{{ colclass }}">
            <table>
        {% endif %}
        {% if valgt_klasse == "live" %}
          <tr id={{ race.display_color }}>
        {% else %}
          <tr id=headerblue>
        {% endif %}
          <td colspan=3>Startliste {{ race.raceclass }}
            {% if race.round == "Q" %}
              Kvartfinale {{ race.heat }}
            {% elif race.round == "S" %}
              Semifinale {{ race.index }}{{ race.heat }}
            {% elif race.round == "F" %}
              Finale {{ race.index }}
            {% endif %}
          </td>
          <td><b>Kl. {{ race.start_time }}</b></td>
            <td colspan=2>{% if race.round != "F" and (valgt_klasse != "live") %}Neste heat: {{ race.next_race }}{% endif %}</td>
        </tr>
        <tr id=subheader>
          <td width=50><div id={{ race.heat }} >Pos</div></td>
          <td width=50>Nr</td>
          <td>Navn</td>
          <td>Klubb</td>
          {% if race.round != "F" and (valgt_klasse != "live") %}
            <td width=50>Plass</td>
            <td>Videre til (heat)</td>
          {% else %}
            <td></td>
            <td></td>
          {% endif %}
        </tr>
        {% for loper in race.startliste %}
            <tr>
              <td>{{ loper.starting_position }}</td>
              <td><div id={{ loper.bib }}></div>{{ loper.bib }}</td>
              <td>
                <a href=live?event_id={{ event_id }}&klasse={{ valgt_klasse }}&startnr={{ loper.bib }}>{{ loper.name }}</a>
              </td>
              <td>{{ loper.club }}</td>
                {% if race.round != "F" and (valgt_klasse != "live") %}
                  <td>{{ loper.starting_position }}</td>
                  <td>{{ loper.next_race }}</td>
                {% else %}
                  <td></td>
                  <td></td>
                {% endif %}
            </tr>
        {% endfor %}
    {% endfor %}
  </table>
  {% endif %} {# note: end competition_format #}
    </div>
  </div>
{% endblock %}
